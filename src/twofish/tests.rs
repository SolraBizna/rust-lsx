use super::*;

#[derive(Debug,PartialEq,Copy,Clone)]
enum Key {
    Key128([u8; 16]),
    Key192([u8; 24]),
    Key256([u8; 32]),
}
use Key::*;

impl Key {
    pub fn setup(&self) -> Twofish {
        match *self {
            Key128(key) => Twofish::new128(&key),
            Key192(key) => Twofish::new192(&key),
            Key256(key) => Twofish::new256(&key),
        }
    }
    pub fn shift_in_key(&mut self, in_key: &[u8]) {
        match *self {
            Key128(_) => {
                *self = Key128(*array_ref!(in_key, 0, 16))
            },
            Key192(key) => {
                let mut new_key = [0u8; 24];
                new_key[16..24].copy_from_slice(&key[0..8]);
                new_key[0..16].copy_from_slice(in_key);
                *self = Key192(new_key)
            },
            Key256(key) => {
                let mut new_key = [0u8; 32];
                new_key[16..32].copy_from_slice(&key[0..16]);
                new_key[0..16].copy_from_slice(in_key);
                *self = Key256(new_key)
            },
        }
    }
}

// from "ecb_ival.txt"
struct EcbIvalEntry {
    who: &'static str,
    key: Key,
    plaintext: [u8; 16],
    ciphertext: [u8; 16],
    calculated_k: [u32; 40],
    calculated_s: [[u32; 256]; 4],
}

const ECB_IVAL_ENTRIES: &[EcbIvalEntry] = &[
    EcbIvalEntry {
        who: "128-bit key schedule",
        key: Key128([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),
        plaintext: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        ciphertext: [0x9F,0x58,0x9F,0x5C,0xF6,0x12,0x2C,0x32,0xB6,0xBF,0xEC,0x2F,0x2A,0xE8,0xC3,0x5A],
        calculated_k: [
            // Input whiten
            0x52C54DDE, 0x11F0626D, 0x7CAC9D4A, 0x4D1B4AAA,
            // Output whiten
            0xB7B83A10, 0x1E7D0BEB, 0xEE9C341F, 0xCFE14BE4,
            // Round subkeys
            0xF98FFEF9, 0x9C5B3C17, 0x15A48310, 0x342A4D81,
            0x424D89FE, 0xC14724A7, 0x311B834C, 0xFDE87320,
            0x3302778F, 0x26CD67B4, 0x7A6C6362, 0xC2BAF60E,
            0x3411B994, 0xD972C87F, 0x84ADB1EA, 0xA7DEE434,
            0x54D2960F, 0xA2F7CAA8, 0xA6B8FF8C, 0x8014C425,
            0x6A748D1C, 0xEDBAF720, 0x928EF78C, 0x0338EE13,
            0x9949D6BE, 0xC8314176, 0x07C07D68, 0xECAE7EA7,
            0x1FE71844, 0x85C05C89, 0xF298311E, 0x696EA672,
        ],
        calculated_s: [
            [
                0x9C9C71B3, 0xF2F2BE98, 0x6464BAD5, 0x2E2E49CE,
                0xDADA03DB, 0xA4A45993, 0x6969CA2F, 0xD0D07625,
                0xF5F5BB9C, 0x68683BA6, 0xC5C56D39, 0x8B8BE1D4,
                0x0B0B8477, 0x9E9EFAC8, 0x3030D6A5, 0xB6B6478B,
                0xF1F1C46A, 0x5D5D637C, 0x1414EA95, 0xFEFE3FEB,
                0xD5D5F85A, 0xBCBC3275, 0xCCCC6235, 0x1B1B1114,
                0x07070504, 0x9696044D, 0xEAEAD57E, 0x8585EBDC,
                0x3131272C, 0x0F0FFB81, 0x8181942A, 0x3333AC57,
                0x7D7D20BA, 0x54546C70, 0x93938A32, 0xE5E52EFF,
                0xE2E22BFB, 0x9090F0C0, 0x2C2CC2B5, 0xD8D888A0,
                0x9D9D803A, 0x7272DB3B, 0x98980E45, 0xE4E4DF76,
                0xD3D30CD7, 0x19199A6F, 0xC7C7E642, 0x6A6AB0DD,
                0x65654B5C, 0x9999FFCC, 0xB7B7B602, 0x1D1DE599,
                0xBBBB3771, 0x4E4E8CED, 0x4A4AF31B, 0xBDBDC3FC,
                0x9A9A853E, 0x2A2A3638, 0xE9E9AF8C, 0xEFEF5B01,
                0x92927BBB, 0x0101F189, 0x5858ED03, 0x0A0A75FE,
                0xAEAE2C6D, 0xE7E7A584, 0xCBCB6731, 0x8C8CE4D0,
                0xDEDE7C2D, 0xC3C399B4, 0x3F3F2D24, 0xAFAFDDE4,
                0xBABAC6F8, 0x5A5A6678, 0xA3A35C97, 0x7E7E5A48,
                0x48487860, 0x0C0C8173, 0x84841A55, 0x3C3C57D6,
                0x4444F913, 0x23233934, 0xA6A6D2E8, 0xE0E0A080,
                0xC1C112CF, 0xF4F44A15, 0x02028B7B, 0x4F4F7D64,
                0xC0C0E346, 0xF3F34F11, 0xABABA212, 0x62624E58,
                0xFDFD4519, 0x50501386, 0xA1A1D7EC, 0x616134AA,
                0x2222C8BD, 0x7F7FABC1, 0x1A1AE09D, 0x91910149,
                0x12121E18, 0x353558DA, 0x0808FE85, 0xD6D682A8,
                0xBEBEB90E, 0xF6F6C16E, 0xDBDBF252, 0xADAD569F,
                0x3B3B52D2, 0xDDDD06DF, 0x3434A953, 0x4545089A,
                0x0D0D70FA, 0x9B9B74B7, 0x88889B26, 0x94948F36,
                0xC2C2683D, 0x7575DE3F, 0xA5A5A81A, 0xEDEDD07A,
                0x17179067, 0x4B4B0292, 0x4343FC17, 0x0E0E0A08,
                0x57571682, 0x161661EE, 0xA0A02665, 0xACACA716,
                0xB4B4CCF0, 0x525298FD, 0xF7F730E7, 0x7A7A25BE,
                0x7676A4CD, 0xFBFBB194, 0x77775544, 0x6363BFD1,
                0xF9F93AEF, 0x36362228, 0x7C7CD133, 0x2D2D333C,
                0xECEC21F3, 0x83831F51, 0x3A3AA35B, 0xD2D2FD5E,
                0xA2A2AD1E, 0x2626B74B, 0xDCDCF756, 0x8F8F9E22,
                0x03037AF2, 0x8D8D1559, 0x2828BD43, 0xFFFFCE62,
                0x18186BE6, 0xCACA96B8, 0x05058E7F, 0xCDCD93BC,
                0x42420D9E, 0x1313EF91, 0xF8F8CB66, 0x3E3EDCAD,
                0x04047FF6, 0xB5B53D79, 0x6767C027, 0x5F5FE807,
                0x55559DF9, 0xA7A72361, 0xB1B1428F, 0xE8E85E05,
                0x1E1E9F6B, 0xD1D187AC, 0x494989E9, 0x00000000,
                0x6D6DB5D9, 0xAAAA539B, 0x2525CDB9, 0x6F6F3EA2,
                0x53536974, 0x878760A7, 0x474783E1, 0x3737D3A1,
                0xEBEB24F7, 0x4D4DF61F, 0xE1E15109, 0x404086E5,
                0xB9B9BC0A, 0x8E8E6FAB, 0x5C5C92F5, 0x808065A3,
                0x95957EBF, 0x8686912E, 0x6B6B4154, 0xB3B3C9F4,
                0x5151E20F, 0x24243C30, 0xB8B84D83, 0xC6C617CB,
                0xC4C49CB0, 0x5B5B97F1, 0xCFCF18C7, 0x5E5E198E,
                0xCECEE94E, 0x666631AE, 0x2B2BC7B1, 0x70705040,
                0x6C6C4450, 0x4141776C, 0x7878AEC5, 0xC9C9EC4A,
                0xC8C81DC3, 0x202043C6, 0x74742FB6, 0x59591C8A,
                0xDFDF8DA4, 0x5656E70B, 0x3939D9A9, 0xD4D409D3,
                0x32325DDE, 0x272746C2, 0x15151B1C, 0xFCFCB490,
                0xA8A8D8E0, 0x111164EA, 0x9797F5C4, 0x2F2FB847,
                0x38382820, 0x7171A1C9, 0xEEEEAA88, 0xE6E6540D,
                0xA9A92969, 0x1C1C1410, 0x8282EED8, 0x1F1F6EE2,
                0x0606F48D, 0x4C4C0796, 0xF0F035E3, 0x89896AAF,
                0x29294CCA, 0x10109563, 0xFAFA401D, 0x8A8A105D,
                0x2121B24F, 0xB2B2387D, 0xD9D97929, 0x46467268,
                0x9F9F0B41, 0xBFBF4887, 0x73732AB2, 0x6060C523,
                0x09090F0C, 0x3D3DA65F, 0xD7D77321, 0x79795F4C,
                0xE3E3DA72, 0xB0B0B306, 0x7B7BD437, 0x6E6ECF2B,
            ],
            [
                0x1FF64D4D, 0xCA4C2929, 0x53A93434, 0x74695353,
                0x3562CCCC, 0x6AC4F1F1, 0x3A809D9D, 0xAC87D1D1,
                0x7B8B0202, 0x242D3F3F, 0x12A2ABAB, 0x647D4F4F,
                0xF321ECEC, 0x9A084545, 0xB896CACA, 0xAF6A8989,
                0xEF3AF9F9, 0xED8C4E4E, 0x86135050, 0x1EADA2A2,
                0x44557777, 0xC5AE7878, 0x0D54E6E6, 0xE1834747,
                0xB5C22C2C, 0xA63B6868, 0x7137BBBB, 0xDF06DDDD,
                0x8DF40606, 0x9B53AAAA, 0xEE611616, 0xC31DC8C8,
                0x94B1FBFB, 0xC4F59797, 0x77840B0B, 0xB62F7474,
                0x91EF1313, 0x8748BFBF, 0x6B9F1E1E, 0xFF2EE5E5,
                0xDA583535, 0x181E1212, 0x8A1C5959, 0xC718CFCF,
                0x85FE0808, 0xFA700D0D, 0xC2462727, 0x88AAEEEE,
                0xF67F0404, 0xA3658080, 0xF99D5555, 0x43BD2828,
                0xAB6F8E8E, 0xF27A0303, 0xF0CCB4B4, 0x328A9393,
                0x17FC4343, 0x3E859A9A, 0x450E9898, 0xDE5D3232,
                0xFB2BE2E2, 0x84A5E7E7, 0x1BF34A4A, 0xDB03DADA,
                0x8F42B1B1, 0x3D68C2C2, 0xD1BF6363, 0xE8D2A6A6,
                0x89F10101, 0x42E6C7C7, 0x27C06767, 0xCE492E2E,
                0x2E918686, 0xA5D63030, 0xA9D93939, 0xDDB06A6A,
                0x73810C0C, 0x7532BCBC, 0x303C2424, 0x015BEFEF,
                0x9E0D4242, 0xD4E18B8B, 0xD70CD3D3, 0xB3719C9C,
                0x06B3B0B0, 0x54416B6B, 0xA7608787, 0x1D40FAFA,
                0x2A948181, 0xEA641111, 0x81FB0F0F, 0x6C774141,
                0x4C5F7979, 0x66CBF8F8, 0xE0D8A8A8, 0xD6573C3C,
                0x90B4FCFC, 0xFE750A0A, 0x2173D7D7, 0x6EC1F6F6,
                0xA48DDFDF, 0x7ED5EAEA, 0x5BA33A3A, 0xF4C9B3B3,
                0xC8FA9E9E, 0x793DB5B5, 0x52F2DBDB, 0x03ED5858,
                0x28223636, 0x6F9A1919, 0x95EA1414, 0x99E51D1D,
                0x3C332D2D, 0x6526A0A0, 0xC9A17171, 0x6D2CAEAE,
                0x3167CBCB, 0x4FB22121, 0x59158D8D, 0xE730F7F7,
                0xCF12C1C1, 0xBDC82222, 0xAE316666, 0x46E3C0C0,
                0xB22A7373, 0x8B47B6B6, 0x7F8E0505, 0x33D17C7C,
                0x5AF8D5D5, 0xB1C72B2B, 0x706C5454, 0x98BEF2F2,
                0xE4DDAFAF, 0xB09CC4C4, 0x9CBBF5F5, 0x82165757,
                0xE5864040, 0x92024B4B, 0xBE257A7A, 0x368F9494,
                0x2D7CDEDE, 0x02B6B7B7, 0x2C273131, 0x68724646,
                0x20283838, 0xA23E6F6F, 0x34392323, 0x72DAE3E3,
                0x584E6262, 0x9DE01A1A, 0x0C0F0909, 0xB499C3C3,
                0x13F94444, 0x8CAFE9E9, 0x834DB8B8, 0x57AC3333,
                0x410B9F9F, 0x7C635D5D, 0xC0F09090, 0xF724EBEB,
                0x16A7ACAC, 0x40507070, 0x5FA63D3D, 0x485A7E7E,
                0xE335F0F0, 0x67901717, 0xC6432020, 0xBA207D7D,
                0xF5925C5C, 0x63951010, 0x76DFE4E4, 0xBB7B9292,
                0xFCC3BDBD, 0x6929A9A9, 0x9359A4A4, 0x1AA8A5A5,
                0x10141C1C, 0xD0E48C8C, 0x7D38B2B2, 0x23C56060,
                0xBC93CDCD, 0xB7749B9B, 0x551A8484, 0xCDA47676,
                0x3FDE7575, 0x4BB72626, 0x0ABCB9B9, 0xBF7E9595,
                0xD5BA6464, 0xF8C6BABA, 0x5EFDD2D2, 0xA882D6D6,
                0xE9894949, 0x975CA3A3, 0xFD985252, 0x14111B1B,
                0x1C1B1515, 0xB9CD2525, 0xECD7A1A1, 0xF1975B5B,
                0xA088D8D8, 0x47B82F2F, 0x2BCF6E6E, 0xADDC3E3E,
                0x62CEFFFF, 0x396DC5C5, 0x5D108A8A, 0xD8EE8282,
                0x56F7DCDC, 0x49019191, 0x9F56ADAD, 0x00000000,
                0x5C4B6565, 0x0BE75656, 0xA1D33737, 0x80A0E0E0,
                0x8E195E5E, 0x78665A5A, 0xD9B56D6D, 0x154AF4F4,
                0xE66B1818, 0xEB3FFEFE, 0x080A0E0E, 0xCCFF9999,
                0x114FF3F3, 0x229E8F8F, 0x1945FDFD, 0x269B8888,
                0x4D049696, 0x7AD0EDED, 0xC1AB7F7F, 0x2576D0D0,
                0x511F8383, 0x4EE9CECE, 0x07E85F5F, 0x0EB9BEBE,
                0x37D47B7B, 0x2FCA6969, 0xAA346161, 0xD2523B3B,
                0x0951E1E1, 0x2979D9D9, 0x96074C4C, 0x4AECC9C9,
                0x50446C6C, 0x04050707, 0x38362A2A, 0x6123A7A7,
                0xDCEB8585, 0xE26E1F1F, 0xCB17C6C6, 0x055EE8E8,
                0xD309D4D4, 0x60784848, 0x3BDB7272, 0x0FE25151,
            ],
            [
                0x3A5B3AA3, 0xA8E0A8D8, 0x345334A9, 0x82D882EE,
                0x23342339, 0xD4D3D409, 0x964D9604, 0xE60DE654,
                0x692F69CA, 0xCDBCCD93, 0xC8C3C81D, 0x018901F1,
                0xE372E3DA, 0x0E080E0A, 0x3BD23B52, 0xA065A026,
                0x35DA3558, 0x4B924B02, 0xB18FB142, 0xFB94FBB1,
                0xD8A0D888, 0x74B6742F, 0x335733AC, 0x2A382A36,
                0x088508FE, 0x794C795F, 0x76CD76A4, 0x17671790,
                0x32DE325D, 0xE109E151, 0x92BB927B, 0x70407050,
                0xB006B0B3, 0x7FC17FAB, 0xBF87BF48, 0x78C578AE,
                0x53745369, 0x598A591C, 0xCC35CC62, 0xC6CBC617,
                0x264B26B7, 0x77447755, 0x9F419F0B, 0xAA9BAA53,
                0x5A785A66, 0xD025D076, 0xEE88EEAA, 0xC539C56D,
                0x139113EF, 0xC3B4C399, 0x0DFA0D70, 0xD1ACD187,
                0x4C964C07, 0xE476E4DF, 0x7DBA7D20, 0xED7AEDD0,
                0x151C151B, 0xF59CF5BB, 0xE784E7A5, 0x027B028B,
                0xA761A723, 0x48604878, 0xD721D773, 0xFA1DFA40,
                0x7E487E5A, 0x39A939D9, 0x5D7C5D63, 0xDADBDA03,
                0x37A137D3, 0xF866F8CB, 0xBC75BC32, 0x95BF957E,
                0x5470546C, 0x1A9D1AE0, 0x61AA6134, 0x4F644F7D,
                0x30A530D6, 0xC94AC9EC, 0xAFE4AFDD, 0xB883B84D,
                0x49E94989, 0xB702B7B6, 0x431743FC, 0x68A6683B,
                0x89AF896A, 0x441344F9, 0x29CA294C, 0x0AFE0A75,
                0x8F228F9E, 0x11EA1164, 0x6C506C44, 0x6B546B41,
                0xF0E3F035, 0x9CB39C71, 0xE2FBE22B, 0xFEEBFE3F,
                0x723B72DB, 0x7ABE7A25, 0xCFC7CF18, 0xF311F34F,
                0x1D991DE5, 0x196F199A, 0xAD9FAD56, 0x0F810FFB,
                0xB27DB238, 0x40E54086, 0x57825716, 0x416C4177,
                0x7B377BD4, 0x6FA26F3E, 0xD25ED2FD, 0x9845980E,
                0xA1ECA1D7, 0x16EE1661, 0xF415F44A, 0x8A5D8A10,
                0x87A78760, 0x36283622, 0x00000000, 0x6E2B6ECF,
                0x8D598D15, 0xFD19FD45, 0x8BD48BE1, 0xAE6DAE2C,
                0x8455841A, 0xEBF7EB24, 0xC1CFC112, 0x4D1F4DF6,
                0x0C730C81, 0x50865013, 0xF16AF1C4, 0x20C62043,
                0xDC56DCF7, 0x459A4508, 0x0B770B84, 0xCE4ECEE9,
                0x214F21B2, 0x91499101, 0x9BB79B74, 0x5F075FE8,
                0xC23DC268, 0x6258624E, 0xA51AA5A8, 0x9A3E9A85,
                0xA493A459, 0x04F6047F, 0xB68BB647, 0x7C337CD1,
                0x2BB12BC7, 0x9332938A, 0xA21EA2AD, 0x753F75DE,
                0xDB52DBF2, 0x5CF55C92, 0x97C497F5, 0x4A1B4AF3,
                0x068D06F4, 0xCAB8CA96, 0x4EED4E8C, 0x602360C5,
                0x1B141B11, 0xD3D7D30C, 0x22BD22C8, 0x64D564BA,
                0x8CD08CE4, 0xF9EFF93A, 0x9436948F, 0x3F243F2D,
                0x812A8194, 0x5E8E5E19, 0x8EAB8E6F, 0x38203828,
                0x18E6186B, 0x312C3127, 0x1FE21F6E, 0x6DD96DB5,
                0x03F2037A, 0xD55AD5F8, 0xBDFCBDC3, 0xD6A8D682,
                0xC046C0E3, 0xC742C7E6, 0xA397A35C, 0x3EAD3EDC,
                0x672767C0, 0x47E14783, 0x1218121E, 0xAC16ACA7,
                0x3CD63C57, 0xAB12ABA2, 0xECF3EC21, 0xB4F0B4CC,
                0xF7E7F730, 0x80A38065, 0x149514EA, 0x10631095,
                0x1E6B1E9F, 0x8826889B, 0xEA7EEAD5, 0x2D3C2D33,
                0x63D163BF, 0x85DC85EB, 0xE98CE9AF, 0x71C971A1,
                0xFF62FFCE, 0x8351831F, 0xEF01EF5B, 0xDDDFDD06,
                0xB579B53D, 0xCB31CB67, 0x862E8691, 0xC4B0C49C,
                0x510F51E2, 0x07040705, 0x2F472FB8, 0x6ADD6AB0,
                0xDFA4DF8D, 0x090C090F, 0x55F9559D, 0xF66EF6C1,
                0x46684672, 0x2ECE2E49, 0x560B56E7, 0x655C654B,
                0xBE0EBEB9, 0x52FD5298, 0xA969A929, 0xB3F4B3C9,
                0x25B925CD, 0x99CC99FF, 0x2CB52CC2, 0x5BF15B97,
                0x284328BD, 0x2430243C, 0xA6E8A6D2, 0x73B2732A,
                0xFC90FCB4, 0xE805E85E, 0x9EC89EFA, 0xDE2DDE7C,
                0x580358ED, 0xB90AB9BC, 0xF298F2BE, 0x429E420D,
                0xBB71BB37, 0xD929D979, 0x1C101C14, 0x9D3A9D80,
                0x90C090F0, 0xBAF8BAC6, 0xE080E0A0, 0x057F058E,
                0x27C22746, 0x3D5F3DA6, 0xE5FFE52E, 0x66AE6631,
            ],
            [
                0xD630A5D6, 0xC3BDFCC3, 0xA7AC16A7, 0x8347E183,
                0xB56DD9B5, 0x6F8EAB6F, 0x2F74B62F, 0x1C598A1C,
                0x00000000, 0x24EBF724, 0x750AFE75, 0xF8D55AF8,
                0x2BE2FB2B, 0x9E8F229E, 0x62CC3562, 0x54E60D54,
                0xA0E080A0, 0xDFE476DF, 0xCEFF62CE, 0x024B9202,
                0x6116EE61, 0xDDAFE4DD, 0x1DC8C31D, 0x5835DA58,
                0xEF1391EF, 0x9F1E6B9F, 0xD7A1ECD7, 0x9B88269B,
                0xCA692FCA, 0x2A73B22A, 0xE6C742E6, 0x6B18E66B,
                0x2EE5FF2E, 0x0D429E0D, 0xE01A9DE0, 0xFC4317FC,
                0xDB723BDB, 0xA476CDA4, 0x207DBA20, 0xD47B37D4,
                0xC6BAF8C6, 0xC22CB5C2, 0x73D72173, 0xFA9EC8FA,
                0x7E95BF7E, 0xAC3357AC, 0x573CD657, 0xB82F47B8,
                0x332D3C33, 0x0F090C0F, 0x96CAB896, 0x635D7C63,
                0xE18BD4E1, 0xB4FC90B4, 0xD337A1D3, 0xF64D1FF6,
                0x12C1CF12, 0x3461AA34, 0x55774455, 0xA5E784A5,
                0x06DDDF06, 0xAFE98CAF, 0x21ECF321, 0x4B655C4B,
                0x17C6CB17, 0x975BF197, 0x30F7E730, 0x6C54706C,
                0xC9B3F4C9, 0x42B18F42, 0x7A03F27A, 0x68C23D68,
                0xF090C0F0, 0xB9BE0EB9, 0xDE753FDE, 0x56AD9F56,
                0x13508613, 0xA171C9A1, 0x59A49359, 0x8DDFA48D,
                0xFDD25EFD, 0x9D55F99D, 0xAAEE88AA, 0xB2214FB2,
                0x88D8A088, 0x195E8E19, 0x6E1FE26E, 0xAE78C5AE,
                0x6411EA64, 0xF34A1BF3, 0x4C29CA4C, 0x810C7381,
                0x4DB8834D, 0xA33A5BA3, 0x0CD3D70C, 0x4627C246,
                0x4FF3114F, 0xF94413F9, 0xADA21EAD, 0x7F04F67F,
                0x4AF4154A, 0x8E057F8E, 0xAB7FC1AB, 0xC1F66EC1,
                0x09D4D309, 0x5D32DE5D, 0xF10189F1, 0x8949E989,
                0x3B68A63B, 0xE3C046E3, 0xBF63D1BF, 0x22362822,
                0xF2DB52F2, 0x27312C27, 0xE85F07E8, 0xFE0885FE,
                0x94812A94, 0xA93453A9, 0xB06ADDB0, 0x93CDBC93,
                0x8B027B8B, 0x8A93328A, 0x859A3E85, 0xE9CE4EE9,
                0xCD25B9CD, 0x39233439, 0x7CDE2D7C, 0x446C5044,
                0x79D92979, 0xEB85DCEB, 0x3FFEEB3F, 0x8F94368F,
                0x2D3F242D, 0xDAE372DA, 0x38B27D38, 0xC06727C0,
                0x6A89AF6A, 0x2CAE6D2C, 0x90176790, 0x523BD252,
                0x48BF8748, 0x3E6FA23E, 0xB6B702B6, 0x53AA9B53,
                0x35F0E335, 0x1E12181E, 0xB7264BB7, 0x87D1AC87,
                0xA8A51AA8, 0xCF6E2BCF, 0x492ECE49, 0x809D3A80,
                0x074C9607, 0x665A7866, 0x16578216, 0xBA64D5BA,
                0x108A5D10, 0x9A196F9A, 0xC822BDC8, 0xE7560BE7,
                0xD0ED7AD0, 0xDC3EADDC, 0x0B9F410B, 0xC4F16AC4,
                0x3166AE31, 0xB3B006B3, 0x700DFA70, 0xCCB4F0CC,
                0x95106395, 0xF7DC56F7, 0x6DC5396D, 0x23A76123,
                0xC56023C5, 0x1B151C1B, 0x416B5441, 0xD17C33D1,
                0x67CB3167, 0xB1FB94B1, 0xEE82D8EE, 0x0E98450E,
                0x26A06526, 0x4320C643, 0x9CC4B09C, 0x362A3836,
                0x18CFC718, 0x749BB774, 0x40FA1D40, 0xFB0F81FB,
                0x1A84551A, 0x77416C77, 0x04964D04, 0x3AF9EF3A,
                0x7B92BB7B, 0xD8A8E0D8, 0xFF99CCFF, 0x6087A760,
                0x05070405, 0x32BC7532, 0x78486078, 0x5BEF015B,
                0x925CF592, 0x01914901, 0xD2A6E8D2, 0xECC94AEC,
                0x47B68B47, 0x45FD1945, 0xED5803ED, 0x37BB7137,
                0x111B1411, 0xF4068DF4, 0x99C3B499, 0x3DB5793D,
                0x72466872, 0xBD2843BD, 0x03DADB03, 0x50704050,
                0x158D5915, 0xC72BB1C7, 0x4E62584E, 0x5CA3975C,
                0x28382028, 0x08459A08, 0x840B7784, 0x1F83511F,
                0x29A96929, 0x82D6A882, 0x7D4F647D, 0xE48CD0E4,
                0x51E10951, 0xEA1495EA, 0x719CB371, 0x5A7E485A,
                0xD5EA7ED5, 0xBBF59CBB, 0x0A0E080A, 0xA63D5FA6,
                0xCBF866CB, 0x5F794C5F, 0xF597C4F5, 0x3C24303C,
                0xBCB90ABC, 0x8C4EED8C, 0x6580A365, 0x8640E586,
                0xBEF298BE, 0xA2AB12A2, 0xE2510FE2, 0x5EE8055E,
                0x141C1014, 0xD939A9D9, 0xE51D99E5, 0x257ABE25,
                0x76D02576, 0x69537469, 0x9852FD98, 0x91862E91,
            ],
        ],
    },
    EcbIvalEntry {
        who: "192-bit key schedule",
        key: Key192([0x01,0x23,0x45,0x67,0x89,0xAB,0xCD,0xEF,0xFE,0xDC,0xBA,0x98,0x76,0x54,0x32,0x10,0x00,0x11,0x22,0x33,0x44,0x55,0x66,0x77]),
        plaintext: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        ciphertext: [0xCF,0xD1,0xD2,0xE5,0xA9,0xBE,0x9C,0xDF,0x50,0x1F,0x13,0xB8,0x92,0xBD,0x22,0x48],
        calculated_k: [
            // Input whiten
            0x38394A24, 0xC36D1175, 0xE802528F, 0x219BFEB4,
            // Output whiten
            0xB9141AB4, 0xBD3E70CD, 0xAF609383, 0xFD36908A,
            // Round subkeys
            0x03EFB931, 0x1D2EE7EC, 0xA7489D55, 0x6E44B6E8,
            0x714AD667, 0x653AD51F, 0xB6315B66, 0xB27C05AF,
            0xA06C8140, 0x9853D419, 0x4016E346, 0x8D1C0DD4,
            0xF05480BE, 0xB6AF816F, 0x2D7DC789, 0x45B7BD3A,
            0x57F8A163, 0x2BEFDA69, 0x26AE7271, 0xC2900D79,
            0xED323794, 0x3D3FFD80, 0x5DE68E49, 0x9C3D2478,
            0xDF326FE3, 0x5911F70D, 0xC229F13B, 0xB1364772,
            0x4235364D, 0x0CEC363A, 0x57C8DD1F, 0x6A1AD61E,
        ],
        calculated_s: [
            [
                0xE1E15109, 0x88889B26, 0xECEC21F3, 0x6060C523,
                0x70705040, 0x202043C6, 0x9F9F0B41, 0xCFCF18C7,
                0xEEEEAA88, 0xDFDF8DA4, 0x59591C8A, 0x525298FD,
                0x68683BA6, 0x57571682, 0x00000000, 0x0606F48D,
                0xBFBF4887, 0x8D8D1559, 0x0F0FFB81, 0xA8A8D8E0,
                0x404086E5, 0x6969CA2F, 0x9A9A853E, 0xBBBB3771,
                0x48487860, 0x8181942A, 0x111164EA, 0xD4D409D3,
                0xF4F44A15, 0xB6B6478B, 0x1313EF91, 0xFAFA401D,
                0xA2A2AD1E, 0x4D4DF61F, 0x3434A953, 0x2C2CC2B5,
                0xC9C9EC4A, 0x29294CCA, 0xFBFBB194, 0x5C5C92F5,
                0x5D5D637C, 0x55559DF9, 0x2D2D333C, 0xE2E22BFB,
                0xC6C617CB, 0xAAAA539B, 0xB0B0B306, 0x15151B1C,
                0x6E6ECF2B, 0x6A6AB0DD, 0x6363BFD1, 0xC4C49CB0,
                0xC5C56D39, 0x8C8CE4D0, 0x92927BBB, 0xCACA96B8,
                0xB5B53D79, 0x42420D9E, 0x05058E7F, 0x6F6F3EA2,
                0x1C1C1410, 0x84841A55, 0x4141776C, 0x3B3B52D2,
                0x3A3AA35B, 0x24243C30, 0x5A5A6678, 0xB4B4CCF0,
                0x1B1B1114, 0x73732AB2, 0x2828BD43, 0xAEAE2C6D,
                0xB7B7B602, 0x1D1DE599, 0xADAD569F, 0x53536974,
                0xF5F5BB9C, 0x5B5B97F1, 0xA7A72361, 0xEDEDD07A,
                0x4C4C0796, 0x09090F0C, 0x79795F4C, 0x7272DB3B,
                0xB9B9BC0A, 0x4A4AF31B, 0x91910149, 0xE7E7A584,
                0x6D6DB5D9, 0x7676A4CD, 0xFEFE3FEB, 0xD3D30CD7,
                0x1414EA95, 0xC7C7E642, 0xD2D2FD5E, 0xA4A45993,
                0x4E4E8CED, 0x9090F0C0, 0x8A8A105D, 0xD9D97929,
                0x77775544, 0x8585EBDC, 0xABABA212, 0xCDCD93BC,
                0x808065A3, 0x7575DE3F, 0x19199A6F, 0x03037AF2,
                0x89896AAF, 0x2B2BC7B1, 0x4343FC17, 0xBDBDC3FC,
                0x38382820, 0x10109563, 0x5E5E198E, 0x8686912E,
                0x5656E70B, 0x7C7CD133, 0xDCDCF756, 0x3D3DA65F,
                0x0808FE85, 0x0101F189, 0x83831F51, 0x9999FFCC,
                0xF6F6C16E, 0xCCCC6235, 0x7171A1C9, 0xB8B84D83,
                0xC8C81DC3, 0xA0A02665, 0x2121B24F, 0x9B9B74B7,
                0x50501386, 0xA6A6D2E8, 0x9696044D, 0xE5E52EFF,
                0x7A7A25BE, 0xEBEB24F7, 0x6B6B4154, 0x3E3EDCAD,
                0xDEDE7C2D, 0xE0E0A080, 0xDBDBF252, 0x07070504,
                0xA1A1D7EC, 0x62624E58, 0xBEBEB90E, 0xCECEE94E,
                0xC0C0E346, 0x1E1E9F6B, 0xD8D888A0, 0x9C9C71B3,
                0xF2F2BE98, 0x2A2A3638, 0x7E7E5A48, 0xBCBC3275,
                0x3131272C, 0xF9F93AEF, 0x3737D3A1, 0x3F3F2D24,
                0x0D0D70FA, 0x65654B5C, 0xDADA03DB, 0xF3F34F11,
                0x94948F36, 0x3939D9A9, 0xFFFFCE62, 0xA3A35C97,
                0x161661EE, 0x4444F913, 0x3333AC57, 0x04047FF6,
                0x2E2E49CE, 0x32325DDE, 0xE9E9AF8C, 0x95957EBF,
                0x36362228, 0x4F4F7D64, 0x2626B74B, 0xF0F035E3,
                0x7D7D20BA, 0xE6E6540D, 0xE8E85E05, 0x5151E20F,
                0xFDFD4519, 0x2222C8BD, 0x5858ED03, 0x0B0B8477,
                0xB2B2387D, 0xBABAC6F8, 0x18186BE6, 0x54546C70,
                0x9E9EFAC8, 0x1F1F6EE2, 0x3030D6A5, 0x02028B7B,
                0xF7F730E7, 0x23233934, 0x9D9D803A, 0xA9A92969,
                0x353558DA, 0x12121E18, 0x7B7BD437, 0xD6D682A8,
                0x8E8E6FAB, 0xEFEF5B01, 0x93938A32, 0xF8F8CB66,
                0x6C6C4450, 0xD0D07625, 0xE4E4DF76, 0x6767C027,
                0x17179067, 0xDDDD06DF, 0x8B8BE1D4, 0xC2C2683D,
                0x4545089A, 0x0C0C8173, 0xF1F1C46A, 0x474783E1,
                0x6464BAD5, 0xCBCB6731, 0x0E0E0A08, 0x494989E9,
                0xD7D77321, 0x4B4B0292, 0x2F2FB847, 0x2525CDB9,
                0x74742FB6, 0x272746C2, 0xE3E3DA72, 0xACACA716,
                0xFCFCB490, 0x98980E45, 0x1A1AE09D, 0xD5D5F85A,
                0x9797F5C4, 0xEAEAD57E, 0x5F5FE807, 0x616134AA,
                0x7F7FABC1, 0xA5A5A81A, 0x46467268, 0xB3B3C9F4,
                0xD1D187AC, 0x8282EED8, 0xB1B1428F, 0xAFAFDDE4,
                0x0A0A75FE, 0x878760A7, 0x3C3C57D6, 0xC1C112CF,
                0x8F8F9E22, 0xC3C399B4, 0x666631AE, 0x7878AEC5,
            ],
            [
                0x5C4B6565, 0x3562CCCC, 0x2BCF6E6E, 0x8748BFBF,
                0xC0F09090, 0x154AF4F4, 0x04050707, 0x2A948181,
                0xB3719C9C, 0x56F7DCDC, 0x5BA33A3A, 0xEF3AF9F9,
                0xFF2EE5E5, 0x1D40FAFA, 0x3C332D2D, 0xEB3FFEFE,
                0x8A1C5959, 0x1EADA2A2, 0x0951E1E1, 0x8E195E5E,
                0x84A5E7E7, 0x1945FDFD, 0xD9B56D6D, 0xE4DDAFAF,
                0xCE492E2E, 0x3167CBCB, 0x2173D7D7, 0x7AD0EDED,
                0xA5D63030, 0xC2462727, 0x5AF8D5D5, 0x6526A0A0,
                0x0C0F0909, 0xA63B6868, 0xA882D6D6, 0xDB03DADA,
                0x82165757, 0x9CBBF5F5, 0x4D049696, 0x6F9A1919,
                0xED8C4E4E, 0xCCFF9999, 0xAE316666, 0x080A0E0E,
                0x8F42B1B1, 0xC1AB7F7F, 0x114FF3F3, 0xC8FA9E9E,
                0x3FDE7575, 0x4AECC9C9, 0x6C774141, 0xE26E1F1F,
                0x17FC4343, 0x00000000, 0x4FB22121, 0xDF06DDDD,
                0x57AC3333, 0xF5925C5C, 0x96074C4C, 0x73810C0C,
                0xF27A0303, 0xE8D2A6A6, 0x410B9F9F, 0x94B1FBFB,
                0xCA4C2929, 0x7B8B0202, 0x4C5F7979, 0x015BEFEF,
                0x98BEF2F2, 0x85FE0808, 0x10141C1C, 0x23C56060,
                0x3E859A9A, 0x9E0D4242, 0x50446C6C, 0x0FE25151,
                0x9B53AAAA, 0x0EB9BEBE, 0x81FB0F0F, 0x450E9898,
                0x368F9494, 0xBC93CDCD, 0xDCEB8585, 0x055EE8E8,
                0x13F94444, 0x6EC1F6F6, 0xA9D93939, 0x0ABCB9B9,
                0xCB17C6C6, 0x38362A2A, 0xF0CCB4B4, 0x47B82F2F,
                0x44557777, 0x7F8E0505, 0x76DFE4E4, 0x78665A5A,
                0x242D3F3F, 0x49019191, 0xF724EBEB, 0xC31DC8C8,
                0xE9894949, 0x92024B4B, 0x68724646, 0x229E8F8F,
                0x4BB72626, 0xDA583535, 0xEE611616, 0xC718CFCF,
                0xCDA47676, 0x7C635D5D, 0x90B4FCFC, 0x67901717,
                0xD5BA6464, 0x975CA3A3, 0xA23E6F6F, 0xB499C3C3,
                0xD70CD3D3, 0x88AAEEEE, 0x6929A9A9, 0xADDC3E3E,
                0x9DE01A1A, 0x03ED5858, 0xDE5D3232, 0x793DB5B5,
                0x396DC5C5, 0xA3658080, 0xF4C9B3B3, 0x07E85F5F,
                0xE335F0F0, 0xF1975B5B, 0x2C273131, 0x8B47B6B6,
                0xE730F7F7, 0x269B8888, 0x72DAE3E3, 0xBB7B9292,
                0xD2523B3B, 0xDDB06A6A, 0x6B9F1E1E, 0x99E51D1D,
                0x6123A7A7, 0x28223636, 0x8DF40606, 0x7532BCBC,
                0x7D38B2B2, 0xEA641111, 0x53A93434, 0xE0D8A8A8,
                0xB5C22C2C, 0x834DB8B8, 0xAF6A8989, 0x62CEFFFF,
                0xFE750A0A, 0xD4E18B8B, 0xD0E48C8C, 0x1BF34A4A,
                0x80A0E0E0, 0xBF7E9595, 0x511F8383, 0xBA207D7D,
                0x66CBF8F8, 0xB7749B9B, 0xD1BF6363, 0x7ED5EAEA,
                0xB896CACA, 0xCF12C1C1, 0x647D4F4F, 0xB1C72B2B,
                0xA48DDFDF, 0x9A084545, 0x12A2ABAB, 0x06B3B0B0,
                0xC6432020, 0xE66B1818, 0x0D54E6E6, 0x7137BBBB,
                0x706C5454, 0x6D2CAEAE, 0xE5864040, 0x584E6262,
                0xFCC3BDBD, 0x74695353, 0x16A7ACAC, 0xF8C6BABA,
                0x4EE9CECE, 0x5FA63D3D, 0x1AA8A5A5, 0xFB2BE2E2,
                0xA1D33737, 0x52F2DBDB, 0xA088D8D8, 0x3A809D9D,
                0x02B6B7B7, 0x91EF1313, 0xECD7A1A1, 0x485A7E7E,
                0x46E3C0C0, 0xD309D4D4, 0x3BDB7272, 0x1C1B1515,
                0x14111B1B, 0x5EFDD2D2, 0xF99D5555, 0xFD985252,
                0xB9CD2525, 0xE1834747, 0x86135050, 0x34392323,
                0x40507070, 0x9359A4A4, 0x42E6C7C7, 0x2E918686,
                0x2979D9D9, 0x60784848, 0xAC87D1D1, 0x89F10101,
                0xFA700D0D, 0x2D7CDEDE, 0x43BD2828, 0x20283838,
                0x3D68C2C2, 0x5D108A8A, 0xC9A17171, 0x1FF64D4D,
                0xD6573C3C, 0x328A9393, 0x63951010, 0x2576D0D0,
                0xB62F7474, 0x54416B6B, 0x59158D8D, 0x303C2424,
                0x8CAFE9E9, 0x27C06767, 0xBE257A7A, 0x9F56ADAD,
                0xB22A7373, 0x551A8484, 0xBDC82222, 0x181E1212,
                0x2FCA6969, 0x6AC4F1F1, 0xC5AE7878, 0xD8EE8282,
                0x33D17C7C, 0x95EA1414, 0xB09CC4C4, 0xAA346161,
                0x37D47B7B, 0xAB6F8E8E, 0xF321ECEC, 0xC4F59797,
                0x77840B0B, 0xA7608787, 0x0BE75656, 0xF67F0404,
            ],
            [
                0x00000000, 0x2BB12BC7, 0xB702B7B6, 0xFD19FD45,
                0xC4B0C49C, 0xF59CF5BB, 0x4B924B02, 0x1FE21F6E,
                0xED7AEDD0, 0xF7E7F730, 0x97C497F5, 0x1C101C14,
                0x723B72DB, 0xC23DC268, 0x7E487E5A, 0x36283622,
                0x04F6047F, 0x49E94989, 0x8D598D15, 0x53745369,
                0xD6A8D682, 0x20C62043, 0xB579B53D, 0x5470546C,
                0x4A1B4AF3, 0xBF87BF48, 0xE805E85E, 0x429E420D,
                0x560B56E7, 0xD025D076, 0x6B546B41, 0xDC56DCF7,
                0x1D991DE5, 0x77447755, 0x672767C0, 0x90C090F0,
                0x018901F1, 0x23342339, 0x3CD63C57, 0x68A6683B,
                0x964D9604, 0x9845980E, 0x71C971A1, 0x196F199A,
                0xCB31CB67, 0x22BD22C8, 0xB4F0B4CC, 0xDADBDA03,
                0xF0E3F035, 0xC1CFC112, 0x3BD23B52, 0x4C964C07,
                0x753F75DE, 0xF298F2BE, 0xC3B4C399, 0x82D882EE,
                0xE5FFE52E, 0x0E080E0A, 0x03F2037A, 0x812A8194,
                0x5A785A66, 0x335733AC, 0x3F243F2D, 0x87A78760,
                0x30A530D6, 0xBE0EBEB9, 0xFEEBFE3F, 0xCDBCCD93,
                0x7B377BD4, 0x74B6742F, 0xBC75BC32, 0x0F810FFB,
                0x416C4177, 0x2A382A36, 0xFA1DFA40, 0x068D06F4,
                0x52FD5298, 0xE080E0A0, 0x3A5B3AA3, 0x9BB79B74,
                0x57825716, 0x6FA26F3E, 0x602360C5, 0x85DC85EB,
                0x6258624E, 0x8F228F9E, 0x345334A9, 0x1218121E,
                0x214F21B2, 0x284328BD, 0xF866F8CB, 0x29CA294C,
                0x441344F9, 0xDB52DBF2, 0x18E6186B, 0xC742C7E6,
                0xECF3EC21, 0xA21EA2AD, 0x0C730C81, 0x0B770B84,
                0xAE6DAE2C, 0xB006B0B3, 0x99CC99FF, 0xE476E4DF,
                0x8EAB8E6F, 0xEA7EEAD5, 0x40E54086, 0xEBF7EB24,
                0xA397A35C, 0xE109E151, 0xB27DB238, 0x6ADD6AB0,
                0x027B028B, 0xFC90FCB4, 0x39A939D9, 0x70407050,
                0xE60DE654, 0x9F419F0B, 0x95BF957E, 0x07040705,
                0xF16AF1C4, 0x8CD08CE4, 0x10631095, 0xC94AC9EC,
                0xD3D7D30C, 0xF66EF6C1, 0x73B2732A, 0x7FC17FAB,
                0x9436948F, 0x27C22746, 0x057F058E, 0x25B925CD,
                0x9A3E9A85, 0x9EC89EFA, 0xD8A0D888, 0x80A38065,
                0x32DE325D, 0x2D3C2D33, 0xF415F44A, 0xA8E0A8D8,
                0x6C506C44, 0x598A591C, 0xD55AD5F8, 0xFB94FBB1,
                0x8A5D8A10, 0x2ECE2E49, 0x794C795F, 0x6DD96DB5,
                0x0AFE0A75, 0x2430243C, 0x3EAD3EDC, 0xE372E3DA,
                0xB883B84D, 0x510F51E2, 0x7C337CD1, 0xC539C56D,
                0x17671790, 0xA1ECA1D7, 0x655C654B, 0x8351831F,
                0xC6CBC617, 0xFF62FFCE, 0xA6E8A6D2, 0x4EED4E8C,
                0x63D163BF, 0x78C578AE, 0xCE4ECEE9, 0x37A137D3,
                0x580358ED, 0x91499101, 0x1A9D1AE0, 0xA493A459,
                0x35DA3558, 0xE98CE9AF, 0xAA9BAA53, 0x9CB39C71,
                0xD929D979, 0xAB12ABA2, 0x431743FC, 0x090C090F,
                0xBDFCBDC3, 0x264B26B7, 0x55F9559D, 0x5CF55C92,
                0xA761A723, 0x5F075FE8, 0xCFC7CF18, 0xC8C3C81D,
                0xB68BB647, 0x4D1F4DF6, 0xD1ACD187, 0xD4D3D409,
                0x5E8E5E19, 0x16EE1661, 0x3D5F3DA6, 0x9D3A9D80,
                0xBB71BB37, 0xE784E7A5, 0xCC35CC62, 0x088508FE,
                0xF9EFF93A, 0x8455841A, 0xAC16ACA7, 0x149514EA,
                0xA065A026, 0x312C3127, 0x139113EF, 0xDFA4DF8D,
                0xAD9FAD56, 0x692F69CA, 0x89AF896A, 0x47E14783,
                0xBAF8BAC6, 0x8826889B, 0x1B141B11, 0x459A4508,
                0x0DFA0D70, 0x38203828, 0xDE2DDE7C, 0x64D564BA,
                0x5BF15B97, 0x66AE6631, 0xB18FB142, 0xD721D773,
                0xE2FBE22B, 0x1E6B1E9F, 0x7DBA7D20, 0xD25ED2FD,
                0xEE88EEAA, 0x9332938A, 0xDDDFDD06, 0xA969A929,
                0x61AA6134, 0xEF01EF5B, 0x48604878, 0x8BD48BE1,
                0x76CD76A4, 0x5D7C5D63, 0x2F472FB8, 0x2CB52CC2,
                0xCAB8CA96, 0x862E8691, 0xAFE4AFDD, 0x92BB927B,
                0xA51AA5A8, 0x6E2B6ECF, 0xF311F34F, 0x7ABE7A25,
                0x4F644F7D, 0x151C151B, 0x46684672, 0x50865013,
                0xC046C0E3, 0xB90AB9BC, 0x11EA1164, 0xB3F4B3C9,
            ],
            [
                0x3C24303C, 0xCEFF62CE, 0x719CB371, 0x55774455,
                0x750AFE75, 0x82D6A882, 0x7E95BF7E, 0xA5E784A5,
                0xDE753FDE, 0x492ECE49, 0x95106395, 0xF8D55AF8,
                0x0B9F410B, 0x73D72173, 0x16578216, 0x700DFA70,
                0x6DC5396D, 0x4FF3114F, 0xBA64D5BA, 0xAB7FC1AB,
                0xECC94AEC, 0xDC3EADDC, 0x37BB7137, 0x77416C77,
                0x1A84551A, 0x749BB774, 0x2CAE6D2C, 0x42B18F42,
                0xBF63D1BF, 0x6411EA64, 0x809D3A80, 0x4DB8834D,
                0x416B5441, 0xD0ED7AD0, 0x1C598A1C, 0xEF1391EF,
                0x9B88269B, 0xC72BB1C7, 0x23A76123, 0xD47B37D4,
                0xEA1495EA, 0xB3B006B3, 0x9A196F9A, 0xF4068DF4,
                0x4E62584E, 0x5A7E485A, 0x17C6CB17, 0xE6C742E6,
                0xF34A1BF3, 0x1F83511F, 0xB82F47B8, 0xAAEE88AA,
                0x111B1411, 0x2EE5FF2E, 0xC6BAF8C6, 0x69537469,
                0x0F090C0F, 0x30F7E730, 0xA33A5BA3, 0xDFE476DF,
                0xC9B3F4C9, 0x3166AE31, 0x39233439, 0xAFE98CAF,
                0x13508613, 0x4627C246, 0x87D1AC87, 0xE3C046E3,
                0xCA692FCA, 0x56AD9F56, 0x1B151C1B, 0xDAE372DA,
                0xC56023C5, 0x8E057F8E, 0x840B7784, 0x810C7381,
                0x207DBA20, 0x925CF592, 0x523BD252, 0x78486078,
                0xAC3357AC, 0xD8A8E0D8, 0x573CD657, 0x62CC3562,
                0x03DADB03, 0x6580A365, 0x22362822, 0x3AF9EF3A,
                0x141C1014, 0xEB85DCEB, 0x7F04F67F, 0x0CD3D70C,
                0xF7DC56F7, 0xCD25B9CD, 0x53AA9B53, 0x2F74B62F,
                0xCBF866CB, 0x27312C27, 0x29A96929, 0x21ECF321,
                0xD5EA7ED5, 0x3E6FA23E, 0x446C5044, 0x05070405,
                0x6F8EAB6F, 0x3DB5793D, 0xE01A9DE0, 0x3461AA34,
                0xB7264BB7, 0xF090C0F0, 0x01914901, 0xC06727C0,
                0x06DDDF06, 0x6A89AF6A, 0x0A0E080A, 0xA8A51AA8,
                0x7D4F647D, 0x99C3B499, 0x8C4EED8C, 0x51E10951,
                0x12C1CF12, 0x76D02576, 0x108A5D10, 0xF94413F9,
                0x8A93328A, 0xA93453A9, 0x8640E586, 0x6116EE61,
                0xD630A5D6, 0xFF99CCFF, 0xC4F16AC4, 0x24EBF724,
                0xE18BD4E1, 0x257ABE25, 0x1DC8C31D, 0xE85F07E8,
                0xDDAFE4DD, 0x3FFEEB3F, 0x26A06526, 0x9D55F99D,
                0xCF6E2BCF, 0xC3BDFCC3, 0x8F94368F, 0xBBF59CBB,
                0x6B18E66B, 0x91862E91, 0xFB0F81FB, 0x38B27D38,
                0x72466872, 0x4320C643, 0x5F794C5F, 0x5835DA58,
                0x859A3E85, 0x00000000, 0xE48CD0E4, 0xC822BDC8,
                0xF10189F1, 0x47B68B47, 0xA2AB12A2, 0xCCB4F0CC,
                0xB6B702B6, 0xAE78C5AE, 0x8347E183, 0x635D7C63,
                0x94812A94, 0xA7AC16A7, 0xEE82D8EE, 0xB06ADDB0,
                0xB1FB94B1, 0xE51D99E5, 0xB9BE0EB9, 0xD939A9D9,
                0xF64D1FF6, 0x9852FD98, 0x40FA1D40, 0xE2510FE2,
                0x48BF8748, 0xB4FC90B4, 0x93CDBC93, 0xBEF298BE,
                0x195E8E19, 0x8B027B8B, 0x08459A08, 0xBCB90ABC,
                0x5CA3975C, 0x7CDE2D7C, 0xD2A6E8D2, 0x9F1E6B9F,
                0x6087A760, 0x7B92BB7B, 0x074C9607, 0x8DDFA48D,
                0x5BEF015B, 0x54E60D54, 0x5EE8055E, 0x18CFC718,
                0x59A49359, 0x04964D04, 0x6C54706C, 0x09D4D309,
                0xC1F66EC1, 0xC22CB5C2, 0x0E98450E, 0x79D92979,
                0xA0E080A0, 0xFC4317FC, 0x32BC7532, 0x35F0E335,
                0xADA21EAD, 0x2D3F242D, 0x50704050, 0x4AF4154A,
                0x2BE2FB2B, 0xB2214FB2, 0x28382028, 0xF2DB52F2,
                0xD7A1ECD7, 0xA63D5FA6, 0x6E1FE26E, 0xDB723BDB,
                0x9CC4B09C, 0x975BF197, 0x362A3836, 0x4B655C4B,
                0x96CAB896, 0xD337A1D3, 0xE9CE4EE9, 0x8949E989,
                0x158D5915, 0x68C23D68, 0xA171C9A1, 0x5D32DE5D,
                0x90176790, 0x9E8F229E, 0xE7560BE7, 0xFA9EC8FA,
                0xBD2843BD, 0xD17C33D1, 0xB56DD9B5, 0xF597C4F5,
                0xA476CDA4, 0x0D429E0D, 0x024B9202, 0x88D8A088,
                0x3B68A63B, 0x2A73B22A, 0xED5803ED, 0x1E12181E,
                0x332D3C33, 0x7A03F27A, 0x67CB3167, 0x4C29CA4C,
                0x665A7866, 0xFDD25EFD, 0x45FD1945, 0xFE0885FE,
            ],
        ],
    },
    EcbIvalEntry {
        who: "256-bit key schedule",
        key: Key256([0x01,0x23,0x45,0x67,0x89,0xAB,0xCD,0xEF,0xFE,0xDC,0xBA,0x98,0x76,0x54,0x32,0x10,0x00,0x11,0x22,0x33,0x44,0x55,0x66,0x77,0x88,0x99,0xAA,0xBB,0xCC,0xDD,0xEE,0xFF]),
        plaintext: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        ciphertext: [0x37,0x52,0x7B,0xE0,0x05,0x23,0x34,0xB8,0x9F,0x0C,0xFC,0xCA,0xE8,0x7C,0xFA,0x20],
        calculated_k: [
            // Input whiten
            0x5EC769BF, 0x44D13C60, 0x76CD39B1, 0x16750474,
            // Output whiten
            0x349C294B, 0xEC21F6D6, 0x4FBD10B4, 0x578DA0ED,
            // Round subkeys
            0xC3479695, 0x9B6958FB, 0x6A7FBC4E, 0x0BF1830B,
            0x61B5E0FB, 0xD78D9730, 0x7C6CF0C4, 0x2F9109C8,
            0xE69EA8D1, 0xED99BDFF, 0x35DC0BBD, 0xA03E5018,
            0xFB18EA0B, 0x38BD43D3, 0x76191781, 0x37A9A0D3,
            0x72427BEA, 0x911CC0B8, 0xF1689449, 0x71009CA9,
            0xB6363E89, 0x494D9855, 0x590BBC63, 0xF95A28B5,
            0xFB72B4E1, 0x2A43505C, 0xBFD34176, 0x5C133D12,
            0x3A9247F7, 0x9A3331DD, 0xEE7515E6, 0xF0D54DCD,
        ],
        calculated_s: [
            [
                0xCDCD93BC, 0xABABA212, 0xC8C81DC3, 0x9797F5C4,
                0xAAAA539B, 0x54546C70, 0x474783E1, 0xD7D77321,
                0xF0F035E3, 0x3434A953, 0x7676A4CD, 0x5D5D637C,
                0x7E7E5A48, 0x7D7D20BA, 0xD5D5F85A, 0xF7F730E7,
                0x79795F4C, 0xC3C399B4, 0x7C7CD133, 0xE9E9AF8C,
                0x55559DF9, 0xB4B4CCF0, 0xC7C7E642, 0xB0B0B306,
                0x8181942A, 0xC5C56D39, 0xD2D2FD5E, 0x8A8A105D,
                0x5A5A6678, 0x3F3F2D24, 0x84841A55, 0x2E2E49CE,
                0x12121E18, 0x9696044D, 0x4545089A, 0x4E4E8CED,
                0x18186BE6, 0x4D4DF61F, 0xEBEB24F7, 0xE0E0A080,
                0xB1B1428F, 0xA2A2AD1E, 0xA8A8D8E0, 0x6A6AB0DD,
                0x04047FF6, 0xF9F93AEF, 0xFFFFCE62, 0x3131272C,
                0x1F1F6EE2, 0x88889B26, 0x42420D9E, 0x9B9B74B7,
                0x4141776C, 0x353558DA, 0x36362228, 0x0F0FFB81,
                0x1D1DE599, 0xB3B3C9F4, 0x1B1B1114, 0x404086E5,
                0x24243C30, 0xDCDCF756, 0x3333AC57, 0xFAFA401D,
                0x93938A32, 0xE4E4DF76, 0x2222C8BD, 0x57571682,
                0x9999FFCC, 0x2121B24F, 0xCACA96B8, 0x5858ED03,
                0x53536974, 0x73732AB2, 0xBDBDC3FC, 0x111164EA,
                0xEAEAD57E, 0x272746C2, 0x0B0B8477, 0x98980E45,
                0x8F8F9E22, 0xF6F6C16E, 0xCBCB6731, 0x0808FE85,
                0xD4D409D3, 0xE2E22BFB, 0x6969CA2F, 0xEDEDD07A,
                0x05058E7F, 0xDDDD06DF, 0x808065A3, 0x07070504,
                0x70705040, 0xD3D30CD7, 0x9090F0C0, 0x46467268,
                0x50501386, 0x2828BD43, 0x95957EBF, 0x10109563,
                0x6363BFD1, 0xF2F2BE98, 0xB2B2387D, 0xF8F8CB66,
                0x3A3AA35B, 0x00000000, 0x09090F0C, 0x2A2A3638,
                0xC1C112CF, 0x4343FC17, 0x9C9C71B3, 0xB9B9BC0A,
                0xFBFBB194, 0x7171A1C9, 0x5E5E198E, 0x7F7FABC1,
                0xDBDBF252, 0xE7E7A584, 0xDADA03DB, 0x15151B1C,
                0x1E1E9F6B, 0xD6D682A8, 0xEEEEAA88, 0x6464BAD5,
                0x3E3EDCAD, 0x4444F913, 0x616134AA, 0xD9D97929,
                0x6C6C4450, 0x02028B7B, 0x5B5B97F1, 0xDEDE7C2D,
                0xCCCC6235, 0x5151E20F, 0xA6A6D2E8, 0x3030D6A5,
                0x7575DE3F, 0x878760A7, 0x17179067, 0x62624E58,
                0x3D3DA65F, 0x5C5C92F5, 0x0D0D70FA, 0x8D8D1559,
                0xF3F34F11, 0x8282EED8, 0xBBBB3771, 0x6E6ECF2B,
                0x9A9A853E, 0x19199A6F, 0xB6B6478B, 0x92927BBB,
                0xB7B7B602, 0x77775544, 0x3B3B52D2, 0x3C3C57D6,
                0x8B8BE1D4, 0x59591C8A, 0x74742FB6, 0xA5A5A81A,
                0xB5B53D79, 0x38382820, 0x4B4B0292, 0xC4C49CB0,
                0xECEC21F3, 0xACACA716, 0xAFAFDDE4, 0xE6E6540D,
                0xC2C2683D, 0xFEFE3FEB, 0x29294CCA, 0x9D9D803A,
                0x91910149, 0x4C4C0796, 0xC9C9EC4A, 0xBCBC3275,
                0xC6C617CB, 0x8C8CE4D0, 0xDFDF8DA4, 0xA1A1D7EC,
                0xD0D07625, 0x161661EE, 0x7878AEC5, 0x3939D9A9,
                0x68683BA6, 0x525298FD, 0xB8B84D83, 0xE3E3DA72,
                0x94948F36, 0x2F2FB847, 0x89896AAF, 0xE8E85E05,
                0x6767C027, 0xA7A72361, 0x8686912E, 0xF1F1C46A,
                0x2D2D333C, 0x1414EA95, 0x65654B5C, 0x0A0A75FE,
                0xF4F44A15, 0x7272DB3B, 0xC0C0E346, 0x0E0E0A08,
                0xE1E15109, 0x6D6DB5D9, 0xE5E52EFF, 0x6B6B4154,
                0x48487860, 0x2626B74B, 0x4F4F7D64, 0xA9A92969,
                0xBABAC6F8, 0xFDFD4519, 0x1313EF91, 0x3737D3A1,
                0x8E8E6FAB, 0x2B2BC7B1, 0xFCFCB490, 0x5656E70B,
                0xA0A02665, 0xD8D888A0, 0xA4A45993, 0x6060C523,
                0xCFCF18C7, 0xCECEE94E, 0x9F9F0B41, 0x1C1C1410,
                0xBFBF4887, 0x2C2CC2B5, 0x23233934, 0xAEAE2C6D,
                0x4A4AF31B, 0x494989E9, 0x202043C6, 0xD1D187AC,
                0x9E9EFAC8, 0x7B7BD437, 0x0C0C8173, 0x8585EBDC,
                0x2525CDB9, 0x5F5FE807, 0x03037AF2, 0xF5F5BB9C,
                0xBEBEB90E, 0x32325DDE, 0xA3A35C97, 0x1A1AE09D,
                0x6F6F3EA2, 0x0606F48D, 0xEFEF5B01, 0x666631AE,
                0x83831F51, 0x7A7A25BE, 0x0101F189, 0xADAD569F,
            ],
            [
                0xE1834747, 0xBC93CDCD, 0x98BEF2F2, 0xA3658080,
                0x16A7ACAC, 0xFB2BE2E2, 0x0FE25151, 0xA5D63030,
                0xAF6A8989, 0xF321ECEC, 0x94B1FBFB, 0xA63B6868,
                0x72DAE3E3, 0xA088D8D8, 0x3D68C2C2, 0x03ED5858,
                0xE26E1F1F, 0xDCEB8585, 0xC5AE7878, 0x8DF40606,
                0x055EE8E8, 0x43BD2828, 0x1BF34A4A, 0xF99D5555,
                0x88AAEEEE, 0xFA700D0D, 0x3562CCCC, 0x6F9A1919,
                0xECD7A1A1, 0x34392323, 0xCA4C2929, 0x37D47B7B,
                0x485A7E7E, 0x410B9F9F, 0x2E918686, 0xA7608787,
                0x6C774141, 0x89F10101, 0x00000000, 0xE9894949,
                0x06B3B0B0, 0xD8EE8282, 0x6526A0A0, 0xD2523B3B,
                0x57AC3333, 0x793DB5B5, 0xCE492E2E, 0x834DB8B8,
                0x49019191, 0x86135050, 0x1FF64D4D, 0xE4DDAFAF,
                0x91EF1313, 0x9B53AAAA, 0xF4C9B3B3, 0x6123A7A7,
                0x114FF3F3, 0xB499C3C3, 0x5C4B6565, 0xD6573C3C,
                0xFD985252, 0xFF2EE5E5, 0x56F7DCDC, 0xD70CD3D3,
                0x47B82F2F, 0x975CA3A3, 0xF27A0303, 0xE8D2A6A6,
                0x242D3F3F, 0x68724646, 0x77840B0B, 0x181E1212,
                0xDDB06A6A, 0xC718CFCF, 0xE730F7F7, 0xD4E18B8B,
                0x450E9898, 0x96074C4C, 0x82165757, 0x85FE0808,
                0x7137BBBB, 0x04050707, 0x95EA1414, 0x59158D8D,
                0xEE611616, 0x1AA8A5A5, 0xA882D6D6, 0xF5925C5C,
                0x2C273131, 0x8A1C5959, 0xB7749B9B, 0xF8C6BABA,
                0xE0D8A8A8, 0x9CBBF5F5, 0xA48DDFDF, 0x76DFE4E4,
                0x2BCF6E6E, 0xBA207D7D, 0xCF12C1C1, 0x7532BCBC,
                0x52F2DBDB, 0xAA346161, 0xA23E6F6F, 0x13F94444,
                0xD9B56D6D, 0xF1975B5B, 0x40507070, 0xA9D93939,
                0x80A0E0E0, 0x0951E1E1, 0x647D4F4F, 0xC6432020,
                0xC8FA9E9E, 0x7B8B0202, 0xAE316666, 0x28223636,
                0x78665A5A, 0xD309D4D4, 0xB09CC4C4, 0x9DE01A1A,
                0x9F56ADAD, 0x07E85F5F, 0xC9A17171, 0x080A0E0E,
                0xD0E48C8C, 0x7ED5EAEA, 0x44557777, 0xCB17C6C6,
                0xC2462727, 0xDF06DDDD, 0x6B9F1E1E, 0x1D40FAFA,
                0x303C2424, 0x84A5E7E7, 0x1EADA2A2, 0xE66B1818,
                0xAB6F8E8E, 0x0BE75656, 0x8748BFBF, 0x66CBF8F8,
                0x38362A2A, 0x62CEFFFF, 0x584E6262, 0x015BEFEF,
                0x4AECC9C9, 0x229E8F8F, 0xDE5D3232, 0xBF7E9595,
                0x90B4FCFC, 0xAC87D1D1, 0x3FDE7575, 0x8F42B1B1,
                0xB5C22C2C, 0x3E859A9A, 0x551A8484, 0x2A948181,
                0x9359A4A4, 0x4FB22121, 0x3167CBCB, 0x6AC4F1F1,
                0x63951010, 0x9E0D4242, 0x14111B1B, 0x3BDB7272,
                0xC31DC8C8, 0x7AD0EDED, 0xF67F0404, 0xE335F0F0,
                0xBE257A7A, 0x20283838, 0x02B6B7B7, 0x396DC5C5,
                0x0D54E6E6, 0x60784848, 0x5EFDD2D2, 0xB22A7373,
                0xDA583535, 0x1945FDFD, 0x99E51D1D, 0x8E195E5E,
                0x269B8888, 0x17FC4343, 0x73810C0C, 0x511F8383,
                0x2173D7D7, 0xB3719C9C, 0x1C1B1515, 0xEB3FFEFE,
                0xCDA47676, 0xCCFF9999, 0xA1D33737, 0xB1C72B2B,
                0x23C56060, 0x54416B6B, 0x10141C1C, 0x3A809D9D,
                0xFCC3BDBD, 0x92024B4B, 0xF724EBEB, 0x67901717,
                0x2576D0D0, 0xFE750A0A, 0xADDC3E3E, 0xB9CD2525,
                0x0EB9BEBE, 0x46E3C0C0, 0xB896CACA, 0xED8C4E4E,
                0x5BA33A3A, 0xD1BF6363, 0x74695353, 0x33D17C7C,
                0x2FCA6969, 0x53A93434, 0xD5BA6464, 0x8CAFE9E9,
                0xC4F59797, 0x706C5454, 0x7D38B2B2, 0xDB03DADA,
                0x4C5F7979, 0xC1AB7F7F, 0x6D2CAEAE, 0xBB7B9292,
                0x6929A9A9, 0xEA641111, 0x2D7CDEDE, 0x4BB72626,
                0xB62F7474, 0x328A9393, 0xBDC82222, 0x0ABCB9B9,
                0x0C0F0909, 0x4D049696, 0x81FB0F0F, 0x12A2ABAB,
                0x27C06767, 0x5FA63D3D, 0x368F9494, 0xF0CCB4B4,
                0xE5864040, 0x7C635D5D, 0x6EC1F6F6, 0x5D108A8A,
                0xEF3AF9F9, 0xC0F09090, 0x154AF4F4, 0x5AF8D5D5,
                0x9A084545, 0x8B47B6B6, 0x7F8E0505, 0x42E6C7C7,
                0x2979D9D9, 0x4EE9CECE, 0x3C332D2D, 0x50446C6C,
            ],
            [
                0x139113EF, 0xF298F2BE, 0x4EED4E8C, 0x6FA26F3E,
                0xAB12ABA2, 0x027B028B, 0x4A1B4AF3, 0x04F6047F,
                0x7ABE7A25, 0x2F472FB8, 0xED7AEDD0, 0x345334A9,
                0xBDFCBDC3, 0xCB31CB67, 0x580358ED, 0x6DD96DB5,
                0x8EAB8E6F, 0xE5FFE52E, 0xDB52DBF2, 0x431743FC,
                0x4B924B02, 0xB90AB9BC, 0x91499101, 0xB4F0B4CC,
                0x52FD5298, 0xC8C3C81D, 0xFA1DFA40, 0x9A3E9A85,
                0xA761A723, 0xDFA4DF8D, 0x87A78760, 0x598A591C,
                0x80A38065, 0x3F243F2D, 0xECF3EC21, 0x560B56E7,
                0xBC75BC32, 0xC046C0E3, 0xC94AC9EC, 0x088508FE,
                0x7E487E5A, 0x30A530D6, 0xF866F8CB, 0x40E54086,
                0xB3F4B3C9, 0x459A4508, 0xD3D7D30C, 0xB006B0B3,
                0x812A8194, 0x6258624E, 0x37A137D3, 0xFEEBFE3F,
                0x39A939D9, 0xF66EF6C1, 0x66AE6631, 0x5D7C5D63,
                0x1A9D1AE0, 0xA397A35C, 0x18E6186B, 0x655C654B,
                0x03F2037A, 0x64D564BA, 0xFB94FBB1, 0x3D5F3DA6,
                0x3EAD3EDC, 0xC1CFC112, 0x862E8691, 0x20C62043,
                0xE805E85E, 0x0F810FFB, 0x71C971A1, 0x2ECE2E49,
                0x35DA3558, 0x4F644F7D, 0x1C101C14, 0x0DFA0D70,
                0x8A5D8A10, 0x9332938A, 0x8BD48BE1, 0x17671790,
                0x97C497F5, 0xCDBCCD93, 0xD6A8D682, 0xC4B0C49C,
                0x8F228F9E, 0x5470546C, 0x8CD08CE4, 0x151C151B,
                0xDC56DCF7, 0xF16AF1C4, 0x602360C5, 0xA065A026,
                0x5A785A66, 0xE080E0A0, 0x3BD23B52, 0x68A6683B,
                0x510F51E2, 0xF415F44A, 0xA8E0A8D8, 0x4D1F4DF6,
                0x1E6B1E9F, 0x6ADD6AB0, 0xA1ECA1D7, 0xFD19FD45,
                0xF59CF5BB, 0x2A382A36, 0x068D06F4, 0x36283622,
                0x29CA294C, 0xCE4ECEE9, 0x22BD22C8, 0x090C090F,
                0x692F69CA, 0x6C506C44, 0x214F21B2, 0xB883B84D,
                0xB27DB238, 0x057F058E, 0x70407050, 0x78C578AE,
                0xCC35CC62, 0xF7E7F730, 0xAFE4AFDD, 0x9F419F0B,
                0x76CD76A4, 0x48604878, 0x1218121E, 0x73B2732A,
                0x335733AC, 0x16EE1661, 0xAD9FAD56, 0x7DBA7D20,
                0x3A5B3AA3, 0x55F9559D, 0x284328BD, 0xF9EFF93A,
                0x441344F9, 0x8351831F, 0xD25ED2FD, 0xB68BB647,
                0x53745369, 0x7FC17FAB, 0x82D882EE, 0x9845980E,
                0x429E420D, 0xFF62FFCE, 0x00000000, 0x264B26B7,
                0x23342339, 0xE60DE654, 0x9CB39C71, 0x2CB52CC2,
                0xB18FB142, 0x4C964C07, 0xB702B7B6, 0x753F75DE,
                0x1FE21F6E, 0xF311F34F, 0x7B377BD4, 0x0E080E0A,
                0x90C090F0, 0x723B72DB, 0x672767C0, 0x5F075FE8,
                0xDADBDA03, 0x92BB927B, 0xEE88EEAA, 0xF0E3F035,
                0xBB71BB37, 0xAA9BAA53, 0xD025D076, 0xA969A929,
                0xEA7EEAD5, 0x89AF896A, 0x1B141B11, 0x1D991DE5,
                0xEF01EF5B, 0xE2FBE22B, 0x0AFE0A75, 0xD929D979,
                0xA6E8A6D2, 0xCAB8CA96, 0x8826889B, 0x9EC89EFA,
                0xEBF7EB24, 0x2BB12BC7, 0x61AA6134, 0xD55AD5F8,
                0x49E94989, 0xE98CE9AF, 0x6E2B6ECF, 0x11EA1164,
                0x964D9604, 0xFC90FCB4, 0x95BF957E, 0x27C22746,
                0xE476E4DF, 0x794C795F, 0xBF87BF48, 0x07040705,
                0xA51AA5A8, 0xE372E3DA, 0x57825716, 0x9436948F,
                0xD721D773, 0x2430243C, 0x7C337CD1, 0xE109E151,
                0x9BB79B74, 0x74B6742F, 0xA493A459, 0x25B925CD,
                0x8D598D15, 0x47E14783, 0x5CF55C92, 0xBAF8BAC6,
                0x0B770B84, 0x3CD63C57, 0x018901F1, 0xD4D3D409,
                0xE784E7A5, 0x416C4177, 0xBE0EBEB9, 0x50865013,
                0x5E8E5E19, 0xCFC7CF18, 0x2D3C2D33, 0x38203828,
                0x149514EA, 0x99CC99FF, 0xC539C56D, 0xA21EA2AD,
                0xAE6DAE2C, 0xD8A0D888, 0x63D163BF, 0x9D3A9D80,
                0x32DE325D, 0xDDDFDD06, 0xDE2DDE7C, 0xAC16ACA7,
                0x85DC85EB, 0x10631095, 0xD1ACD187, 0xC23DC268,
                0xC3B4C399, 0x8455841A, 0xC6CBC617, 0x46684672,
                0x312C3127, 0x6B546B41, 0x5BF15B97, 0xB579B53D,
                0x77447755, 0xC742C7E6, 0x0C730C81, 0x196F199A,
            ],
            [
                0x4627C246, 0x7B92BB7B, 0xEA1495EA, 0x1DC8C31D,
                0x0CD3D70C, 0x4320C643, 0xF34A1BF3, 0x9B88269B,
                0x9D55F99D, 0xCF6E2BCF, 0x93CDBC93, 0x1E12181E,
                0x95106395, 0x30F7E730, 0x16578216, 0x0D429E0D,
                0x1C598A1C, 0x074C9607, 0x76D02576, 0xEE82D8EE,
                0x4E62584E, 0xEB85DCEB, 0xFF99CCFF, 0xC1F66EC1,
                0x8DDFA48D, 0x78486078, 0xC56023C5, 0x2CAE6D2C,
                0x59A49359, 0x48BF8748, 0x257ABE25, 0x24EBF724,
                0x23A76123, 0x56AD9F56, 0xB3B006B3, 0x2BE2FB2B,
                0x750AFE75, 0x749BB774, 0x2D3F242D, 0xC72BB1C7,
                0x5F794C5F, 0xA2AB12A2, 0x4B655C4B, 0x3AF9EF3A,
                0xA5E784A5, 0x6116EE61, 0xA171C9A1, 0x47B68B47,
                0x05070405, 0xA63D5FA6, 0xAB7FC1AB, 0x6B18E66B,
                0xB4FC90B4, 0x665A7866, 0xC6BAF8C6, 0x859A3E85,
                0x91862E91, 0x38B27D38, 0x17C6CB17, 0xB2214FB2,
                0x32BC7532, 0xFE0885FE, 0xF2DB52F2, 0x141C1014,
                0xD2A6E8D2, 0x72466872, 0x207DBA20, 0x108A5D10,
                0x4DB8834D, 0xF8D55AF8, 0x03DADB03, 0x18CFC718,
                0x87D1AC87, 0x6DC5396D, 0x492ECE49, 0x35F0E335,
                0x1B151C1B, 0x3DB5793D, 0x9A196F9A, 0x08459A08,
                0xD8A8E0D8, 0x3B68A63B, 0x446C5044, 0xCD25B9CD,
                0xBD2843BD, 0x158D5915, 0x523BD252, 0x925CF592,
                0x2F74B62F, 0xCEFF62CE, 0x5EE8055E, 0x68C23D68,
                0x06DDDF06, 0x94812A94, 0x37BB7137, 0xF94413F9,
                0xE3C046E3, 0xE6C742E6, 0x3FFEEB3F, 0x9F1E6B9F,
                0x8949E989, 0xBF63D1BF, 0xDAE372DA, 0xD17C33D1,
                0xADA21EAD, 0x8C4EED8C, 0x04964D04, 0x111B1411,
                0xF7DC56F7, 0x8B027B8B, 0x840B7784, 0x6F8EAB6F,
                0xF64D1FF6, 0x29A96929, 0x8640E586, 0x3C24303C,
                0x90176790, 0xC3BDFCC3, 0x7E95BF7E, 0x67CB3167,
                0x8347E183, 0x01914901, 0x975BF197, 0xED5803ED,
                0xD5EA7ED5, 0x54E60D54, 0x195E8E19, 0x719CB371,
                0xBCB90ABC, 0x88D8A088, 0x573CD657, 0x73D72173,
                0xD630A5D6, 0x7CDE2D7C, 0xA7AC16A7, 0x69537469,
                0x53AA9B53, 0x2EE5FF2E, 0xFB0F81FB, 0xF10189F1,
                0x024B9202, 0x28382028, 0x27312C27, 0x3E6FA23E,
                0xA476CDA4, 0x6C54706C, 0xF090C0F0, 0x50704050,
                0x5CA3975C, 0xA93453A9, 0x21ECF321, 0xA8A51AA8,
                0x9852FD98, 0x5BEF015B, 0x12C1CF12, 0xB6B702B6,
                0xD939A9D9, 0xDC3EADDC, 0x0F090C0F, 0x1A84551A,
                0x26A06526, 0xCCB4F0CC, 0xE01A9DE0, 0x62CC3562,
                0xC06727C0, 0x22362822, 0xD47B37D4, 0xAAEE88AA,
                0x0B9F410B, 0xC4F16AC4, 0xCBF866CB, 0x3166AE31,
                0xDE753FDE, 0x2A73B22A, 0xDDAFE4DD, 0xD0ED7AD0,
                0xAC3357AC, 0xB7264BB7, 0x40FA1D40, 0xCA692FCA,
                0x7F04F67F, 0xBA64D5BA, 0x00000000, 0xC22CB5C2,
                0xAFE98CAF, 0x82D6A882, 0x6E1FE26E, 0xE2510FE2,
                0x7D4F647D, 0x6411EA64, 0x7A03F27A, 0x5D32DE5D,
                0xA33A5BA3, 0xFA9EC8FA, 0xD7A1ECD7, 0xFC4317FC,
                0xD337A1D3, 0x99C3B499, 0x8F94368F, 0x4C29CA4C,
                0x96CAB896, 0xB06ADDB0, 0xB9BE0EB9, 0xE9CE4EE9,
                0x39233439, 0x1F83511F, 0xB82F47B8, 0xBBF59CBB,
                0x6A89AF6A, 0x55774455, 0x362A3836, 0x0E98450E,
                0x13508613, 0xB56DD9B5, 0xC822BDC8, 0x77416C77,
                0x6087A760, 0x5835DA58, 0x332D3C33, 0x810C7381,
                0x700DFA70, 0x8E057F8E, 0x42B18F42, 0xE85F07E8,
                0x809D3A80, 0x0A0E080A, 0xB1FB94B1, 0xDFE476DF,
                0x9CC4B09C, 0xEF1391EF, 0xBEF298BE, 0xE51D99E5,
                0x6580A365, 0xF4068DF4, 0x8A93328A, 0x79D92979,
                0xE48CD0E4, 0xECC94AEC, 0xAE78C5AE, 0xC9B3F4C9,
                0x4AF4154A, 0x51E10951, 0xA0E080A0, 0x09D4D309,
                0xE7560BE7, 0x45FD1945, 0x4FF3114F, 0xE18BD4E1,
                0x3461AA34, 0x5A7E485A, 0xDB723BDB, 0xF597C4F5,
                0xFDD25EFD, 0x9E8F229E, 0x635D7C63, 0x416B5441,
            ],
        ],
    },
];

// from "ecb_tbl.txt"
struct EcbTblEntry {
    who: &'static str,
    key: Key,
    first_ten_and_last_two: [[u8; 16]; 12],
}
const ECB_TBL_ENTRIES: &[EcbTblEntry] = &[
    EcbTblEntry {
        who: "128-bit repeated encryption",
        key: Key128([0u8; 16]),
        first_ten_and_last_two: [
            [0x9F,0x58,0x9F,0x5C,0xF6,0x12,0x2C,0x32,0xB6,0xBF,0xEC,0x2F,0x2A,0xE8,0xC3,0x5A],
            [0xD4,0x91,0xDB,0x16,0xE7,0xB1,0xC3,0x9E,0x86,0xCB,0x08,0x6B,0x78,0x9F,0x54,0x19],
            [0x01,0x9F,0x98,0x09,0xDE,0x17,0x11,0x85,0x8F,0xAA,0xC3,0xA3,0xBA,0x20,0xFB,0xC3],
            [0x63,0x63,0x97,0x7D,0xE8,0x39,0x48,0x62,0x97,0xE6,0x61,0xC6,0xC9,0xD6,0x68,0xEB],
            [0x81,0x6D,0x5B,0xD0,0xFA,0xE3,0x53,0x42,0xBF,0x2A,0x74,0x12,0xC2,0x46,0xF7,0x52],
            [0x54,0x49,0xEC,0xA0,0x08,0xFF,0x59,0x21,0x15,0x5F,0x59,0x8A,0xF4,0xCE,0xD4,0xD0],
            [0x66,0x00,0x52,0x2E,0x97,0xAE,0xB3,0x09,0x4E,0xD5,0xF9,0x2A,0xFC,0xBC,0xDD,0x10],
            [0x34,0xC8,0xA5,0xFB,0x2D,0x3D,0x08,0xA1,0x70,0xD1,0x20,0xAC,0x6D,0x26,0xDB,0xFA],
            [0x28,0x53,0x0B,0x35,0x8C,0x1B,0x42,0xEF,0x27,0x7D,0xE6,0xD4,0x40,0x7F,0xC5,0x91],
            [0x8A,0x8A,0xB9,0x83,0x31,0x0E,0xD7,0x8C,0x8C,0x0E,0xCD,0xE0,0x30,0xB8,0xDC,0xA4],
            [0x6B,0x45,0x92,0x86,0xF3,0xFF,0xD2,0x8D,0x49,0xF1,0x5B,0x15,0x81,0xB0,0x8E,0x42],
            [0x5D,0x9D,0x4E,0xEF,0xFA,0x91,0x51,0x57,0x55,0x24,0xF1,0x15,0x81,0x5A,0x12,0xE0]
        ]
    },
    EcbTblEntry {
        who:"192-bit repeated encryption",
        key: Key192([0u8; 24]),
        first_ten_and_last_two: [
            [0xEF,0xA7,0x1F,0x78,0x89,0x65,0xBD,0x44,0x53,0xF8,0x60,0x17,0x8F,0xC1,0x91,0x01],
            [0x88,0xB2,0xB2,0x70,0x6B,0x10,0x5E,0x36,0xB4,0x46,0xBB,0x6D,0x73,0x1A,0x1E,0x88],
            [0x39,0xDA,0x69,0xD6,0xBA,0x49,0x97,0xD5,0x85,0xB6,0xDC,0x07,0x3C,0xA3,0x41,0xB2],
            [0x18,0x2B,0x02,0xD8,0x14,0x97,0xEA,0x45,0xF9,0xDA,0xAC,0xDC,0x29,0x19,0x3A,0x65],
            [0x7A,0xFF,0x7A,0x70,0xCA,0x2F,0xF2,0x8A,0xC3,0x1D,0xD8,0xAE,0x5D,0xAA,0xAB,0x63],
            [0xD1,0x07,0x9B,0x78,0x9F,0x66,0x66,0x49,0xB6,0xBD,0x7D,0x16,0x29,0xF1,0xF7,0x7E],
            [0x3A,0xF6,0xF7,0xCE,0x5B,0xD3,0x5E,0xF1,0x8B,0xEC,0x6F,0xA7,0x87,0xAB,0x50,0x6B],
            [0xAE,0x81,0x09,0xBF,0xDA,0x85,0xC1,0xF2,0xC5,0x03,0x8B,0x34,0xED,0x69,0x1B,0xFF],
            [0x89,0x3F,0xD6,0x7B,0x98,0xC5,0x50,0x07,0x35,0x71,0xBD,0x63,0x12,0x63,0xFC,0x78],
            [0x16,0x43,0x4F,0xC9,0xC8,0x84,0x1A,0x63,0xD5,0x87,0x00,0xB5,0x57,0x8E,0x8F,0x67],
            [0xF0,0xAB,0x73,0x30,0x11,0x25,0xFA,0x21,0xEF,0x70,0xBE,0x53,0x85,0xFB,0x76,0xB6],
            [0xE7,0x54,0x49,0x21,0x2B,0xEE,0xF9,0xF4,0xA3,0x90,0xBD,0x86,0x0A,0x64,0x09,0x41]
        ]
    },
    EcbTblEntry {
        who: "256-bit repeated encryption",
        key: Key256([0u8; 32]),
        first_ten_and_last_two: [
            [0x57,0xFF,0x73,0x9D,0x4D,0xC9,0x2C,0x1B,0xD7,0xFC,0x01,0x70,0x0C,0xC8,0x21,0x6F],
            [0xD4,0x3B,0xB7,0x55,0x6E,0xA3,0x2E,0x46,0xF2,0xA2,0x82,0xB7,0xD4,0x5B,0x4E,0x0D],
            [0x90,0xAF,0xE9,0x1B,0xB2,0x88,0x54,0x4F,0x2C,0x32,0xDC,0x23,0x9B,0x26,0x35,0xE6],
            [0x6C,0xB4,0x56,0x1C,0x40,0xBF,0x0A,0x97,0x05,0x93,0x1C,0xB6,0xD4,0x08,0xE7,0xFA],
            [0x30,0x59,0xD6,0xD6,0x17,0x53,0xB9,0x58,0xD9,0x2F,0x47,0x81,0xC8,0x64,0x0E,0x58],
            [0xE6,0x94,0x65,0x77,0x05,0x05,0xD7,0xF8,0x0E,0xF6,0x8C,0xA3,0x8A,0xB3,0xA3,0xD6],
            [0x5A,0xB6,0x7A,0x5F,0x85,0x39,0xA4,0xA5,0xFD,0x9F,0x03,0x73,0xBA,0x46,0x34,0x66],
            [0xDC,0x09,0x6B,0xCD,0x99,0xFC,0x72,0xF7,0x99,0x36,0xD4,0xC7,0x48,0xE7,0x5A,0xF7],
            [0xC5,0xA3,0xE7,0xCE,0xE0,0xF1,0xB7,0x26,0x05,0x28,0xA6,0x8F,0xB4,0xEA,0x05,0xF2],
            [0x43,0xD5,0xCE,0xC3,0x27,0xB2,0x4A,0xB9,0x0A,0xD3,0x4A,0x79,0xD0,0x46,0x91,0x51],
            [0x43,0x10,0x58,0xF4,0xDB,0xC7,0xF7,0x34,0xDA,0x4F,0x02,0xF0,0x4C,0xC4,0xF4,0x59],
            [0x37,0xFE,0x26,0xFF,0x1C,0xF6,0x61,0x75,0xF5,0xDD,0xF4,0xC3,0x3B,0x97,0xA2,0x05]
        ]
    },
];

#[test]
pub fn ecb_ival() {
    let mut ok = true;
    for test in ECB_IVAL_ENTRIES {
        println!("{}", test.who);
        let mut twofish = test.key.setup();
        print!("  S-boxes: ");
        for i in 0..4 {
            if &twofish.s[i][..] == &test.calculated_s[i][..] {
                print!("Y");
            }
            else {
                ok = false;
                print!("N");
            }
        }
        print!("\n");
        println!("  K: {}{}",
                 if &twofish.w[..] == &test.calculated_k[0..8] { 'Y' }
                 else { ok = false; 'N' },
                 if &twofish.k[..] == &test.calculated_k[8..40] { 'Y' }
                 else { ok = false; 'N' });
        let mut our_ciphertext = [0u8; 16];
        let mut our_plaintext = [0u8; 16];
        twofish.encrypt(&test.plaintext, &mut our_ciphertext);
        twofish.decrypt(&our_ciphertext, &mut our_plaintext);
        println!("  EnDe: {}{}",
                 if &test.ciphertext == &our_ciphertext { 'Y' }
                 else { ok = false; 'N' },
                 if &test.plaintext == &our_plaintext { 'Y' }
                 else { ok = false; 'N' });
        twofish.s = test.calculated_s;
        twofish.encrypt(&test.plaintext, &mut our_ciphertext);
        twofish.decrypt(&our_ciphertext, &mut our_plaintext);
        println!("  EnDe(FS): {}{}",
                 if &test.ciphertext == &our_ciphertext { 'Y' }
                 else { ok = false; 'N' },
                 if &test.plaintext == &our_plaintext { 'Y' }
                 else { ok = false; 'N' });
        twofish.w = *array_ref!(test.calculated_k, 0, 8);
        twofish.k = *array_ref!(test.calculated_k, 8, 32);
        println!("  EnDe(FSK): {}{}",
                 if &test.ciphertext == &our_ciphertext { 'Y' }
                 else { ok = false; 'N' },
                 if &test.plaintext == &our_plaintext { 'Y' }
                 else { ok = false; 'N' });
    }
    if !ok { panic!("Not okay! (see stdout)") }
}

#[test]
pub fn ecb_tbl() {
    let mut ok = true;
    for test in ECB_TBL_ENTRIES {
        print!("{}: ", test.who);
        let mut key = test.key;
        let mut plaintext = [0u8; BLOCKBYTES];
        let mut ciphertext = [0u8; BLOCKBYTES];
        for i in 0 ..= 48 {
            let twofish = key.setup();
            twofish.encrypt(&plaintext, &mut ciphertext);
            let known_index = match i {
                x if x < 10 => Some(x),
                x if x >= 47 => Some(x-37),
                _ => None,
            };
            if let Some(known_index) = known_index {
                if ciphertext == &test.first_ten_and_last_two[known_index][..]{
                    print!("Y");
                }
                else {
                    ok = false;
                    print!("N");
                }
            }
            else if i == 10 {
                print!("...");
            }
            key.shift_in_key(&plaintext[..]);
            plaintext = ciphertext;
        }
        print!("\n");
    }
    if !ok { panic!("Not okay! (see stdout)") }
}
